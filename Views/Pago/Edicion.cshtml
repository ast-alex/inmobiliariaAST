@model inmobiliariaAST.Models.Pago

@{
    ViewBag.Title = "Editar Pago";
}

<h2>Editar Pago Número @Model.Numero_pago</h2>

<form id="formPago" asp-action="Edicion" method="post">
    <div class="form-group">
        <label for="Numero_pago">Número de Pago</label>
        <input type="number" asp-for="Numero_pago" class="form-control" readonly />
    </div>

    <div class="form-group">
        <label for="Fecha_pago">Fecha de Pago</label>
        <input type="date" asp-for="Fecha_pago" class="form-control" readonly />
    </div>

    <div class="form-group">
        <label for="Importe">Importe</label>
        <input type="number" asp-for="Importe" class="form-control" readonly />
    </div>

    <div class="form-group">
        <label for="Concepto">Concepto</label>
        <input type="text" asp-for="Concepto" class="form-control" 
               data-original="@Model.Concepto" />
    </div>

    <input type="hidden" asp-for="ID_pago" />
    <input type="hidden" asp-for="ID_contrato" />

    <button type="submit" class="btn btn-primary">Guardar cambios</button>
    <a href="@Url.Action("Index", "Pago", new { idContrato = Model.ID_contrato })" class="btn btn-secondary">Volver</a>
</form>

@section Scripts {
    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}

    <script>
        document.getElementById('formPago').addEventListener('submit', function(e) {
            let form = e.target;
            let changed = false;

            form.querySelectorAll('input[data-original]').forEach(el => {
                let original = el.dataset.original || "";
                let value = el.value || "";
                if(value !== original) changed = true;
            });

            if(!changed) {
                e.preventDefault();
                Swal.fire({
                    title: 'Sin cambios',
                    text: 'No se detectaron cambios para guardar.',
                    icon: 'info',
                    confirmButtonText: 'OK'
                });
            }
        });
    </script>
}
